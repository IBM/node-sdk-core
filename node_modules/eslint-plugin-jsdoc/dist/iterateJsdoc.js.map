{"version":3,"sources":["../src/iterateJsdoc.js"],"names":["globalState","Map","getBasicUtils","context","tagNamePreference","mode","utils","reportSettings","message","report","loc","start","column","line","parseClosureTemplateTag","tag","jsdocUtils","pathDoesNotBeginWith","getPreferredTagNameObject","tagName","ret","getPreferredTagName","isObject","replacement","blocked","getUtils","node","jsdoc","jsdocNode","settings","iteratingAll","ruleConfig","indent","ancestors","getAncestors","sourceCode","getSourceCode","overrideReplacesDocs","implementsReplacesDocs","augmentsExtendsReplacesDocs","maxLines","minLines","isIteratingFunction","includes","type","isVirtualFunction","hasATag","stringify","tagBlock","specRewire","reportJSDoc","msg","handler","fixer","replaceText","getRegexFromString","str","requiredFlags","getTagDescription","tg","descriptions","source","some","tokens","end","postDelimiter","postTag","name","description","desc","slice","push","join","getDescription","lastDescriptionLine","idx","changeTag","forEach","src","setTag","number","delimiter","removeTag","removeTagItem","tagIndex","tagSourceOffset","tagSource","tags","lastIndex","firstNumber","tagIdx","sourceIndex","findIndex","srcNumber","spliceCount","splice","addTag","targetTagName","length","seedTokens","addLine","addLines","numLines","makeLine","makeLines","Array","from","lines","flattenRoots","params","getFunctionParameterNames","useDefaultObjectProperties","hasParams","isGenerator","generator","value","declaration","isConstructor","getJsdocTagsDeep","skipReportingBlockedTag","allowObjectReturn","defaultMessage","hasTag","getTags","isValidTag","definedTags","names","comparePaths","dropPathSegmentQuotes","avoidDocs","classHasTag","exemptSpeciaMethods","meta","schema","exemptedBy","options","getPresentTags","method","otherModeMaps","result","otherResult","otherModeMap","otherMode","every","getTagStructureForMode","mde","structuredTags","hasDefinedTypeTag","hasValueOrExecutorHasNonEmptyResolveValue","anyPromiseAsReturn","hasYieldValue","hasYieldReturnValue","hasThrowValue","isAsync","async","filterTags","item","tagList","filter","getTagsByType","hasOptionTag","Boolean","getClassNode","reverse","find","parent","getClassJsdoc","classNode","classJsdocNode","indnt","repeat","classJsdoc","forEachPreferredTag","arrayHandler","matchingJsdocTags","_","matchingJsdocTag","getSettings","ignorePrivate","ignoreInternal","Number","preferredTypes","parserPath","setTagStructure","overrideTagStructure","error","makeReport","commentNode","fix","jsdocLoc","data","lineNumber","colNumber","iterate","info","iterator","state","checkInternal","checkPrivate","getIndentAndJSDoc","sourceLine","charAt","jsdc","iterateAllJsdocs","trackedJsdocs","callIterator","jsdocNodes","lastCall","test","getText","exit","create","reducedNode","comment","nonComment","allComments","getAllComments","untrackedJSdoc","checkFile","iterateJsdoc","metaType","TypeError","contexts","contextDefaults","contextSelected","enforcedContexts","checkJsdoc","contextObject","getContextObject","prop","bind","selector"],"mappings":";;;;;;;;;;;;;;AAAA;;AAGA;;AAGA;;AAIA;;AACA;;;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA,MAAMA,WAAW,GAAG,IAAIC,GAAJ,EAApB;;AAEA,MAAMC,aAAa,GAAG,CAACC,OAAD,EAAU;AAACC,EAAAA,iBAAD;AAAoBC,EAAAA;AAApB,CAAV,KAAwC;AAC5D,QAAMC,KAAK,GAAG,EAAd;;AACAA,EAAAA,KAAK,CAACC,cAAN,GAAwBC,OAAD,IAAa;AAClCL,IAAAA,OAAO,CAACM,MAAR,CAAe;AACbC,MAAAA,GAAG,EAAE;AACHC,QAAAA,KAAK,EAAE;AACLC,UAAAA,MAAM,EAAE,CADH;AAELC,UAAAA,IAAI,EAAE;AAFD;AADJ,OADQ;AAObL,MAAAA;AAPa,KAAf;AASD,GAVD;;AAYAF,EAAAA,KAAK,CAACQ,uBAAN,GAAiCC,GAAD,IAAS;AACvC,WAAOC,oBAAWF,uBAAX,CAAmCC,GAAnC,CAAP;AACD,GAFD;;AAIAT,EAAAA,KAAK,CAACW,oBAAN,GAA6BD,oBAAWC,oBAAxC;;AAEAX,EAAAA,KAAK,CAACY,yBAAN,GAAkC,CAAC;AAACC,IAAAA;AAAD,GAAD,KAAe;AAC/C,UAAMC,GAAG,GAAGJ,oBAAWK,mBAAX,CAA+BlB,OAA/B,EAAwCE,IAAxC,EAA8Cc,OAA9C,EAAuDf,iBAAvD,CAAZ;;AACA,UAAMkB,QAAQ,GAAGF,GAAG,IAAI,OAAOA,GAAP,KAAe,QAAvC;;AACA,QAAIA,GAAG,KAAK,KAAR,IAAiBE,QAAQ,IAAI,CAACF,GAAG,CAACG,WAAtC,EAAmD;AACjD,aAAO;AACLC,QAAAA,OAAO,EAAE,IADJ;AAELL,QAAAA;AAFK,OAAP;AAID;;AAED,WAAOC,GAAP;AACD,GAXD;;AAaA,SAAOd,KAAP;AACD,CAlCD;;AAoCA,MAAMmB,QAAQ,GAAG,CACfC,IADe,EAEfC,KAFe,EAGfC,SAHe,EAIfC,QAJe,EAKfpB,MALe,EAMfN,OANe,EAOf2B,YAPe,EAQfC,UARe,EASfC,MATe,KAUZ;AACH,QAAMC,SAAS,GAAG9B,OAAO,CAAC+B,YAAR,EAAlB;AACA,QAAMC,UAAU,GAAGhC,OAAO,CAACiC,aAAR,EAAnB;AAEA,QAAM9B,KAAK,GAAGJ,aAAa,CAACC,OAAD,EAAU0B,QAAV,CAA3B;AAEA,QAAM;AACJzB,IAAAA,iBADI;AAEJiC,IAAAA,oBAFI;AAGJC,IAAAA,sBAHI;AAIJC,IAAAA,2BAJI;AAKJC,IAAAA,QALI;AAMJC,IAAAA,QANI;AAOJpC,IAAAA;AAPI,MAQFwB,QARJ;;AAUAvB,EAAAA,KAAK,CAACoC,mBAAN,GAA4B,MAAM;AAChC,WAAO,CAACZ,YAAD,IAAiB,CACtB,kBADsB,EAEtB,yBAFsB,EAGtB,qBAHsB,EAItB,oBAJsB,EAKtBa,QALsB,CAKbjB,IAAI,IAAIA,IAAI,CAACkB,IALA,CAAxB;AAMD,GAPD;;AASAtC,EAAAA,KAAK,CAACuC,iBAAN,GAA0B,MAAM;AAC9B,WAAOf,YAAY,IAAIxB,KAAK,CAACwC,OAAN,CAAc,CAAC,UAAD,EAAa,UAAb,EAAyB,MAAzB,EAAiC,QAAjC,CAAd,CAAvB;AACD,GAFD;;AAIAxC,EAAAA,KAAK,CAACyC,SAAN,GAAkB,CAACC,QAAD,EAAWC,UAAX,KAA0B;AAC1C,WAAO,8BAAiBA,UAAU,GAAG,uBAAYD,QAAZ,CAAH,GAA2BA,QAAtD,CAAP;AACD,GAFD;;AAIA1C,EAAAA,KAAK,CAAC4C,WAAN,GAAoB,CAACC,GAAD,EAAMpC,GAAN,EAAWqC,OAAX,EAAoBH,UAApB,KAAmC;AACrDxC,IAAAA,MAAM,CAAC0C,GAAD,EAAMC,OAAO,GAAIC,KAAD,IAAW;AAC/BD,MAAAA,OAAO;AACP,YAAM7B,WAAW,GAAGjB,KAAK,CAACyC,SAAN,CAAgBpB,KAAhB,EAAuBsB,UAAvB,CAApB;AAEA,aAAOI,KAAK,CAACC,WAAN,CAAkB1B,SAAlB,EAA6BL,WAA7B,CAAP;AACD,KALkB,GAKf,IALE,EAKIR,GALJ,CAAN;AAMD,GAPD;;AASAT,EAAAA,KAAK,CAACiD,kBAAN,GAA2B,CAACC,GAAD,EAAMC,aAAN,KAAwB;AACjD,WAAOzC,oBAAWuC,kBAAX,CAA8BC,GAA9B,EAAmCC,aAAnC,CAAP;AACD,GAFD;;AAIAnD,EAAAA,KAAK,CAACoD,iBAAN,GAA2BC,EAAD,IAAQ;AAChC,UAAMC,YAAY,GAAG,EAArB;AACAD,IAAAA,EAAE,CAACE,MAAH,CAAUC,IAAV,CAAe,CAAC;AACdC,MAAAA,MAAM,EAAE;AAACC,QAAAA,GAAD;AAAMC,QAAAA,aAAN;AAAqBlD,QAAAA,GAArB;AAA0BmD,QAAAA,OAA1B;AAAmCC,QAAAA,IAAnC;AAAyCvB,QAAAA,IAAzC;AAA+CwB,QAAAA;AAA/C;AADM,KAAD,KAET;AACJ,YAAMC,IAAI,GAAG,CACXtD,GAAG,IAAImD,OAAP,IACA,CAACnD,GAAD,IAAQ,CAACoD,IAAT,IAAiB,CAACvB,IAAlB,IAA0BqB,aAD1B,IAC2C,EAFhC,CAIb;AAJa,QAKXK,KALW,CAKL,CALK,KAMVF,WAAW,IAAI,EANL,CAAb;;AAQA,UAAIJ,GAAJ,EAAS;AACP,YAAIK,IAAJ,EAAU;AACRT,UAAAA,YAAY,CAACW,IAAb,CAAkBF,IAAlB;AACD;;AAED,eAAO,IAAP;AACD;;AACDT,MAAAA,YAAY,CAACW,IAAb,CAAkBF,IAAlB;AAEA,aAAO,KAAP;AACD,KArBD;AAuBA,WAAOT,YAAY,CAACY,IAAb,CAAkB,IAAlB,CAAP;AACD,GA1BD;;AA4BAlE,EAAAA,KAAK,CAACmE,cAAN,GAAuB,MAAM;AAC3B,UAAMb,YAAY,GAAG,EAArB;AACA,QAAIc,mBAAmB,GAAG,CAA1B;AACA/C,IAAAA,KAAK,CAACkC,MAAN,CAAaC,IAAb,CAAkB,CAAC;AAACC,MAAAA,MAAM,EAAE;AAACK,QAAAA,WAAD;AAAcrD,QAAAA,GAAd;AAAmBiD,QAAAA;AAAnB;AAAT,KAAD,EAAoCW,GAApC,KAA4C;AAC5D,UAAIA,GAAG,KAAK5D,GAAG,IAAIiD,GAAZ,CAAP,EAAyB;AACvBU,QAAAA,mBAAmB,GAAGC,GAAG,GAAG,CAA5B;AAEA,eAAO,IAAP;AACD;;AACD,UAAIA,GAAG,IAAIP,WAAX,EAAwB;AACtBR,QAAAA,YAAY,CAACW,IAAb,CAAkBH,WAAlB;AACD;;AAED,aAAO,KAAP;AACD,KAXD;AAaA,WAAO;AACLA,MAAAA,WAAW,EAAER,YAAY,CAACY,IAAb,CAAkB,IAAlB,CADR;AAELE,MAAAA;AAFK,KAAP;AAID,GApBD;;AAsBApE,EAAAA,KAAK,CAACsE,SAAN,GAAkB,CAAC7D,GAAD,EAAM,GAAGgD,MAAT,KAAoB;AACpChD,IAAAA,GAAG,CAAC8C,MAAJ,CAAWgB,OAAX,CAAmB,CAACC,GAAD,EAAMH,GAAN,KAAc;AAC/BG,MAAAA,GAAG,CAACf,MAAJ,GAAa,EACX,GAAGe,GAAG,CAACf,MADI;AAEX,WAAGA,MAAM,CAACY,GAAD;AAFE,OAAb;AAID,KALD;AAMD,GAPD;;AASArE,EAAAA,KAAK,CAACyE,MAAN,GAAe,CAAChE,GAAD,EAAMgD,MAAN,KAAiB;AAC9BhD,IAAAA,GAAG,CAAC8C,MAAJ,GAAa,CAAC;AACZ;AACAmB,MAAAA,MAAM,EAAEjE,GAAG,CAACF,IAFA;AAGZkD,MAAAA,MAAM,EAAE,sBAAW;AACjBkB,QAAAA,SAAS,EAAE,GADM;AAEjBhB,QAAAA,aAAa,EAAE,GAFE;AAGjBtD,QAAAA,KAAK,EAAEqB,MAAM,GAAG,GAHC;AAIjBjB,QAAAA,GAAG,EAAE,MAAMA,GAAG,CAACA,GAJE;AAKjB,WAAGgD;AALc,OAAX;AAHI,KAAD,CAAb;AAWD,GAZD;;AAcAzD,EAAAA,KAAK,CAAC4E,SAAN,GAAmBP,GAAD,IAAS;AACzB,WAAOrE,KAAK,CAAC6E,aAAN,CAAoBR,GAApB,CAAP;AACD,GAFD;;AAIArE,EAAAA,KAAK,CAAC6E,aAAN,GAAsB,CAACC,QAAD,EAAWC,eAAe,GAAG,CAA7B,KAAmC;AACvD,UAAM;AAACxB,MAAAA,MAAM,EAAEyB;AAAT,QAAsB3D,KAAK,CAAC4D,IAAN,CAAWH,QAAX,CAA5B;AACA,QAAII,SAAJ;AACA,UAAMC,WAAW,GAAG9D,KAAK,CAACkC,MAAN,CAAa,CAAb,EAAgBmB,MAApC;AACAM,IAAAA,SAAS,CAACxB,IAAV,CAAe,CAAC;AAACkB,MAAAA;AAAD,KAAD,EAAWU,MAAX,KAAsB;AACnC,YAAMC,WAAW,GAAGhE,KAAK,CAACkC,MAAN,CAAa+B,SAAb,CAAuB,CAAC;AAC1CZ,QAAAA,MAAM,EAAEa,SADkC;AACvB9B,QAAAA,MAAM,EAAE;AAACC,UAAAA;AAAD;AADe,OAAD,KAErC;AACJ,eAAOgB,MAAM,KAAKa,SAAX,IAAwB,CAAC7B,GAAhC;AACD,OAJmB,CAApB,CADmC,CAMnC;;AACA,UAAI2B,WAAW,GAAG,CAAC,CAAnB,EAAsB;AACpB,YAAIG,WAAW,GAAG,CAAlB;AACAR,QAAAA,SAAS,CAAChB,KAAV,CAAgBoB,MAAM,GAAG,CAAzB,EAA4B5B,IAA5B,CAAiC,CAAC;AAACC,UAAAA,MAAM,EAAE;AAAChD,YAAAA,GAAD;AAAMiD,YAAAA;AAAN;AAAT,SAAD,KAA0B;AACzD,cAAI,CAACjD,GAAD,IAAQ,CAACiD,GAAb,EAAkB;AAChB8B,YAAAA,WAAW;AAEX,mBAAO,KAAP;AACD;;AAED,iBAAO,IAAP;AACD,SARD;AASAnE,QAAAA,KAAK,CAACkC,MAAN,CAAakC,MAAb,CAAoBJ,WAAW,GAAGN,eAAlC,EAAmDS,WAAW,GAAGT,eAAjE;AACAC,QAAAA,SAAS,CAACS,MAAV,CAAiBL,MAAM,GAAGL,eAA1B,EAA2CS,WAAW,GAAGT,eAAzD;AACAG,QAAAA,SAAS,GAAGG,WAAZ;AAEA,eAAO,IAAP;AACD,OAvBkC,CAyBnC;;;AACA,aAAO,KAAP;AACD,KA3BD;AA4BAhE,IAAAA,KAAK,CAACkC,MAAN,CAAaS,KAAb,CAAmBkB,SAAnB,EAA8BX,OAA9B,CAAsC,CAACC,GAAD,EAAMH,GAAN,KAAc;AAClDG,MAAAA,GAAG,CAACE,MAAJ,GAAaS,WAAW,GAAGD,SAAd,GAA0Bb,GAAvC;AACD,KAFD;AAGD,GAnCD;;AAqCArE,EAAAA,KAAK,CAAC0F,MAAN,GAAgBC,aAAD,IAAmB;AAAA;;AAChC,UAAMjB,MAAM,GAAG,yCAACrD,KAAK,CAAC4D,IAAN,CAAW5D,KAAK,CAAC4D,IAAN,CAAWW,MAAX,GAAoB,CAA/B,CAAD,uEAAC,YAAmCrC,MAAnC,CAA0C,CAA1C,CAAD,wDAAC,oBAA8CmB,MAA/C,yEAAyD,CAAzD,IAA8D,CAA7E;AACArD,IAAAA,KAAK,CAACkC,MAAN,CAAakC,MAAb,CAAoBf,MAApB,EAA4B,CAA5B,EAA+B;AAC7BA,MAAAA,MAD6B;AAE7BnB,MAAAA,MAAM,EAAE,EAFqB;AAG7BE,MAAAA,MAAM,EAAE,sBAAW;AACjBkB,QAAAA,SAAS,EAAE,GADM;AAEjBhB,QAAAA,aAAa,EAAE,GAFE;AAGjBtD,QAAAA,KAAK,EAAEqB,MAAM,GAAG,GAHC;AAIjBjB,QAAAA,GAAG,EAAG,IAAGkF,aAAc;AAJN,OAAX;AAHqB,KAA/B;AAUAtE,IAAAA,KAAK,CAACkC,MAAN,CAAaS,KAAb,CAAmBU,MAAM,GAAG,CAA5B,EAA+BH,OAA/B,CAAwCC,GAAD,IAAS;AAC9CA,MAAAA,GAAG,CAACE,MAAJ;AACD,KAFD;AAGD,GAfD;;AAiBA1E,EAAAA,KAAK,CAAC6F,UAAN,GAAmBA,gBAAnB;;AAEA7F,EAAAA,KAAK,CAAC8F,OAAN,GAAgB,CAACT,WAAD,EAAc5B,MAAd,KAAyB;AAAA;;AACvC,UAAMiB,MAAM,GAAG,CAAC,kBAAArD,KAAK,CAACkC,MAAN,CAAa8B,WAAW,GAAG,CAA3B,iEAA+BX,MAA/B,KAAyC,CAA1C,IAA+C,CAA9D;AACArD,IAAAA,KAAK,CAACkC,MAAN,CAAakC,MAAb,CAAoBJ,WAApB,EAAiC,CAAjC,EAAoC;AAClCX,MAAAA,MADkC;AAElCnB,MAAAA,MAAM,EAAE,EAF0B;AAGlCE,MAAAA,MAAM,EAAE,sBAAWA,MAAX;AAH0B,KAApC,EAFuC,CAQvC;AACA;AACD,GAVD;;AAYAzD,EAAAA,KAAK,CAAC+F,QAAN,GAAiB,CAACjB,QAAD,EAAWC,eAAX,EAA4BiB,QAA5B,KAAyC;AACxD,UAAM;AAACzC,MAAAA,MAAM,EAAEyB;AAAT,QAAsB3D,KAAK,CAAC4D,IAAN,CAAWH,QAAX,CAA5B;AACA,QAAII,SAAJ;AACA,UAAMC,WAAW,GAAG9D,KAAK,CAACkC,MAAN,CAAa,CAAb,EAAgBmB,MAApC;AACAM,IAAAA,SAAS,CAACxB,IAAV,CAAe,CAAC;AAACkB,MAAAA;AAAD,KAAD,KAAc;AAC3B,YAAMuB,QAAQ,GAAG,MAAM;AACrB,eAAO;AACLvB,UAAAA,MADK;AAELnB,UAAAA,MAAM,EAAE,EAFH;AAGLE,UAAAA,MAAM,EAAE,sBAAW;AACjBkB,YAAAA,SAAS,EAAE,GADM;AAEjBtE,YAAAA,KAAK,EAAEqB,MAAM,GAAG;AAFC,WAAX;AAHH,SAAP;AAQD,OATD;;AAUA,YAAMwE,SAAS,GAAG,MAAM;AACtB,eAAOC,KAAK,CAACC,IAAN,CAAW;AAACR,UAAAA,MAAM,EAAEI;AAAT,SAAX,EAA+BC,QAA/B,CAAP;AACD,OAFD;;AAGA,YAAMZ,WAAW,GAAGhE,KAAK,CAACkC,MAAN,CAAa+B,SAAb,CAAuB,CAAC;AAC1CZ,QAAAA,MAAM,EAAEa,SADkC;AACvB9B,QAAAA,MAAM,EAAE;AAACC,UAAAA;AAAD;AADe,OAAD,KAErC;AACJ,eAAOgB,MAAM,KAAKa,SAAX,IAAwB,CAAC7B,GAAhC;AACD,OAJmB,CAApB,CAd2B,CAmB3B;;AACA,UAAI2B,WAAW,GAAG,CAAC,CAAnB,EAAsB;AACpB,cAAMgB,KAAK,GAAGH,SAAS,EAAvB;AACA7E,QAAAA,KAAK,CAACkC,MAAN,CAAakC,MAAb,CAAoBJ,WAAW,GAAGN,eAAlC,EAAmD,CAAnD,EAAsD,GAAGsB,KAAzD,EAFoB,CAIpB;;AACAnB,QAAAA,SAAS,GAAGG,WAAZ;AAEA,eAAO,IAAP;AACD,OA5B0B,CA8B3B;;;AACA,aAAO,KAAP;AACD,KAhCD;AAiCAhE,IAAAA,KAAK,CAACkC,MAAN,CAAaS,KAAb,CAAmBkB,SAAnB,EAA8BX,OAA9B,CAAsC,CAACC,GAAD,EAAMH,GAAN,KAAc;AAClDG,MAAAA,GAAG,CAACE,MAAJ,GAAaS,WAAW,GAAGD,SAAd,GAA0Bb,GAAvC;AACD,KAFD;AAGD,GAxCD;;AA0CArE,EAAAA,KAAK,CAACsG,YAAN,GAAsBC,MAAD,IAAY;AAC/B,WAAO7F,oBAAW4F,YAAX,CAAwBC,MAAxB,CAAP;AACD,GAFD;;AAIAvG,EAAAA,KAAK,CAACwG,yBAAN,GAAmCC,0BAAD,IAAgC;AAChE,WAAO/F,oBAAW8F,yBAAX,CAAqCpF,IAArC,EAA2CqF,0BAA3C,CAAP;AACD,GAFD;;AAIAzG,EAAAA,KAAK,CAAC0G,SAAN,GAAkB,MAAM;AACtB,WAAOhG,oBAAWgG,SAAX,CAAqBtF,IAArB,CAAP;AACD,GAFD;;AAIApB,EAAAA,KAAK,CAAC2G,WAAN,GAAoB,MAAM;AACxB,WAAOvF,IAAI,KACTA,IAAI,CAACwF,SAAL,IACAxF,IAAI,CAACkB,IAAL,KAAc,kBAAd,IAAoClB,IAAI,CAACyF,KAAL,CAAWD,SAD/C,IAEA,CAAC,wBAAD,EAA2B,0BAA3B,EAAuDvE,QAAvD,CAAgEjB,IAAI,CAACkB,IAArE,KACElB,IAAI,CAAC0F,WAAL,CAAiBF,SAJV,CAAX;AAMD,GAPD;;AASA5G,EAAAA,KAAK,CAAC+G,aAAN,GAAsB,MAAM;AAC1B,WAAOrG,oBAAWqG,aAAX,CAAyB3F,IAAzB,CAAP;AACD,GAFD;;AAIApB,EAAAA,KAAK,CAACgH,gBAAN,GAA0BnG,OAAD,IAAa;AACpC,UAAMgD,IAAI,GAAG7D,KAAK,CAACe,mBAAN,CAA0B;AAACF,MAAAA;AAAD,KAA1B,CAAb;;AACA,QAAI,CAACgD,IAAL,EAAW;AACT,aAAO,KAAP;AACD;;AAED,WAAOnD,oBAAWsG,gBAAX,CAA4B3F,KAA5B,EAAmCwC,IAAnC,CAAP;AACD,GAPD;;AASA7D,EAAAA,KAAK,CAACe,mBAAN,GAA4B,CAAC;AAACF,IAAAA,OAAD;AAAUoG,IAAAA,uBAAuB,GAAG,KAApC;AAA2CC,IAAAA,iBAAiB,GAAG,KAA/D;AAAsEC,IAAAA,cAAc,GAAI,qBAAoBtG,OAAQ;AAApH,GAAD,KAA8H;AACxJ,UAAMC,GAAG,GAAGJ,oBAAWK,mBAAX,CAA+BlB,OAA/B,EAAwCE,IAAxC,EAA8Cc,OAA9C,EAAuDf,iBAAvD,CAAZ;;AACA,UAAMkB,QAAQ,GAAGF,GAAG,IAAI,OAAOA,GAAP,KAAe,QAAvC;;AACA,QAAId,KAAK,CAACoH,MAAN,CAAavG,OAAb,MAA0BC,GAAG,KAAK,KAAR,IAAiBE,QAAQ,IAAI,CAACF,GAAG,CAACG,WAA5D,CAAJ,EAA8E;AAC5E,UAAIgG,uBAAJ,EAA6B;AAC3B,eAAO;AACL/F,UAAAA,OAAO,EAAE,IADJ;AAELL,UAAAA;AAFK,SAAP;AAID;;AACD,YAAMX,OAAO,GAAGc,QAAQ,IAAIF,GAAG,CAACZ,OAAhB,IAA2BiH,cAA3C;AACAhH,MAAAA,MAAM,CAACD,OAAD,EAAU,IAAV,EAAgBF,KAAK,CAACqH,OAAN,CAAcxG,OAAd,EAAuB,CAAvB,CAAhB,CAAN;AAEA,aAAO,KAAP;AACD;;AAED,WAAOG,QAAQ,IAAI,CAACkG,iBAAb,GAAiCpG,GAAG,CAACG,WAArC,GAAmDH,GAA1D;AACD,GAjBD;;AAmBAd,EAAAA,KAAK,CAACsH,UAAN,GAAmB,CAACzD,IAAD,EAAO0D,WAAP,KAAuB;AACxC,WAAO7G,oBAAW4G,UAAX,CAAsBzH,OAAtB,EAA+BE,IAA/B,EAAqC8D,IAArC,EAA2C0D,WAA3C,CAAP;AACD,GAFD;;AAIAvH,EAAAA,KAAK,CAACwC,OAAN,GAAiBgF,KAAD,IAAW;AACzB,WAAO9G,oBAAW8B,OAAX,CAAmBnB,KAAnB,EAA0BmG,KAA1B,CAAP;AACD,GAFD;;AAIAxH,EAAAA,KAAK,CAACoH,MAAN,GAAgBvD,IAAD,IAAU;AACvB,WAAOnD,oBAAW0G,MAAX,CAAkB/F,KAAlB,EAAyBwC,IAAzB,CAAP;AACD,GAFD;;AAIA7D,EAAAA,KAAK,CAACyH,YAAN,GAAsB5D,IAAD,IAAU;AAC7B,WAAOnD,oBAAW+G,YAAX,CAAwB5D,IAAxB,CAAP;AACD,GAFD;;AAIA7D,EAAAA,KAAK,CAAC0H,qBAAN,GAA+B7D,IAAD,IAAU;AACtC,WAAOnD,oBAAWgH,qBAAX,CAAiC7D,IAAjC,CAAP;AACD,GAFD;;AAIA7D,EAAAA,KAAK,CAAC2H,SAAN,GAAkB,MAAM;AAAA;;AACtB,QACE5F,oBAAoB,KAAK,KAAzB,KACG/B,KAAK,CAACoH,MAAN,CAAa,UAAb,KAA4BpH,KAAK,CAAC4H,WAAN,CAAkB,UAAlB,CAD/B,KAEA5F,sBAAsB,KAAK,KAA3B,KACGhC,KAAK,CAACoH,MAAN,CAAa,YAAb,KAA8BpH,KAAK,CAAC4H,WAAN,CAAkB,YAAlB,CADjC,CAFA,IAKA3F,2BAA2B,KACxBjC,KAAK,CAACwC,OAAN,CAAc,CAAC,UAAD,EAAa,SAAb,CAAd,KACCxC,KAAK,CAAC4H,WAAN,CAAkB,UAAlB,CADD,IAEG5H,KAAK,CAAC4H,WAAN,CAAkB,SAAlB,CAHqB,CAN7B,EASuC;AACrC,aAAO,IAAP;AACD;;AAED,QAAIlH,oBAAWmH,mBAAX,CACFxG,KADE,EACKD,IADL,EACWvB,OADX,EACoB4B,UAAU,CAACqG,IAAX,CAAgBC,MADpC,CAAJ,EAEG;AACD,aAAO,IAAP;AACD;;AAED,UAAMC,UAAU,iDAAGnI,OAAO,CAACoI,OAAR,CAAgB,CAAhB,CAAH,sDAAG,kBAAoBD,UAAvB,yEAAqC,CACnD,YADmD,EAEnD,IAAGjI,IAAI,KAAK,SAAT,GAAqB,EAArB,GAA0B,CAAC,YAAD,CAA7B,CAFmD,CAArD;;AAIA,QAAIiI,UAAU,CAACpC,MAAX,IAAqB5F,KAAK,CAACkI,cAAN,CAAqBF,UAArB,EAAiCpC,MAA1D,EAAkE;AAChE,aAAO,IAAP;AACD;;AAED,WAAO,KAAP;AACD,GA7BD;;AA+BA,GACE,0BADF,EAEE,0BAFF,EAGErB,OAHF,CAGW4D,MAAD,IAAY;AACpBnI,IAAAA,KAAK,CAACmI,MAAD,CAAL,GAAgB,CAACtH,OAAD,EAAUuH,aAAV,KAA4B;AAC1C,YAAMC,MAAM,GAAG3H,oBAAWyH,MAAX,EAAmBtH,OAAnB,CAAf;;AACA,UAAIwH,MAAJ,EAAY;AACV,eAAO,IAAP;AACD;;AAED,UAAI,CAACD,aAAL,EAAoB;AAClB,eAAO,KAAP;AACD;;AAED,YAAME,WAAW,GAAGF,aAAa,CAAC5E,IAAd,CAAoB+E,YAAD,IAAkB;AACvD,eAAO7H,oBAAWyH,MAAX,EAAmBtH,OAAnB,EAA4B0H,YAA5B,CAAP;AACD,OAFmB,CAApB;AAIA,aAAOD,WAAW,GAAG;AAACE,QAAAA,SAAS,EAAE;AAAZ,OAAH,GAAuB,KAAzC;AACD,KAfD;AAgBD,GApBD;AAsBA,GACE,yBADF,EAEE,yBAFF,EAGE,kCAHF,EAIEjE,OAJF,CAIW4D,MAAD,IAAY;AACpBnI,IAAAA,KAAK,CAACmI,MAAD,CAAL,GAAgB,CAACtH,OAAD,EAAUuH,aAAV,KAA4B;AAC1C,YAAMC,MAAM,GAAG3H,oBAAWyH,MAAX,EAAmBtH,OAAnB,CAAf;;AACA,UAAI,CAACwH,MAAL,EAAa;AACX,eAAO,KAAP;AACD,OAJyC,CAM1C;;;AAEA,YAAMC,WAAW,GAAGF,aAAa,CAACK,KAAd,CAAqBF,YAAD,IAAkB;AACxD,eAAO7H,oBAAWyH,MAAX,EAAmBtH,OAAnB,EAA4B0H,YAA5B,CAAP;AACD,OAFmB,CAApB;AAIA,aAAOD,WAAW,GAAG,IAAH,GAAU;AAACE,QAAAA,SAAS,EAAE;AAAZ,OAA5B;AACD,KAbD;AAcD,GAnBD;AAqBA,GACE,uBADF,EAEE,sBAFF,EAGEjE,OAHF,CAGW4D,MAAD,IAAY;AACpBnI,IAAAA,KAAK,CAACmI,MAAD,CAAL,GAAiBtH,OAAD,IAAa;AAC3B,aAAOH,oBAAWyH,MAAX,EAAmBtH,OAAnB,CAAP;AACD,KAFD;AAGD,GAPD;;AASAb,EAAAA,KAAK,CAAC0I,sBAAN,GAAgCC,GAAD,IAAS;AACtC,WAAOjI,oBAAWgI,sBAAX,CAAkCC,GAAlC,EAAuCpH,QAAQ,CAACqH,cAAhD,CAAP;AACD,GAFD;;AAIA5I,EAAAA,KAAK,CAAC6I,iBAAN,GAA2BpI,GAAD,IAAS;AACjC,WAAOC,oBAAWmI,iBAAX,CAA6BpI,GAA7B,CAAP;AACD,GAFD;;AAIAT,EAAAA,KAAK,CAAC8I,yCAAN,GAAmDC,kBAAD,IAAwB;AACxE,WAAOrI,oBAAWoI,yCAAX,CAAqD1H,IAArD,EAA2D2H,kBAA3D,CAAP;AACD,GAFD;;AAIA/I,EAAAA,KAAK,CAACgJ,aAAN,GAAsB,MAAM;AAC1B,QAAI,CAAC,wBAAD,EAA2B,0BAA3B,EAAuD3G,QAAvD,CAAgEjB,IAAI,CAACkB,IAArE,CAAJ,EAAgF;AAC9E,aAAO5B,oBAAWsI,aAAX,CAAyB5H,IAAI,CAAC0F,WAA9B,CAAP;AACD;;AAED,WAAOpG,oBAAWsI,aAAX,CAAyB5H,IAAzB,CAAP;AACD,GAND;;AAQApB,EAAAA,KAAK,CAACiJ,mBAAN,GAA4B,MAAM;AAChC,WAAOvI,oBAAWsI,aAAX,CAAyB5H,IAAzB,EAA+B,IAA/B,CAAP;AACD,GAFD;;AAIApB,EAAAA,KAAK,CAACkJ,aAAN,GAAsB,MAAM;AAC1B,WAAOxI,oBAAWwI,aAAX,CAAyB9H,IAAzB,CAAP;AACD,GAFD;;AAIApB,EAAAA,KAAK,CAACmJ,OAAN,GAAgB,MAAM;AACpB,WAAO/H,IAAI,CAACgI,KAAZ;AACD,GAFD;;AAIApJ,EAAAA,KAAK,CAACqH,OAAN,GAAiBxG,OAAD,IAAa;AAC3B,WAAOb,KAAK,CAACqJ,UAAN,CAAkBC,IAAD,IAAU;AAChC,aAAOA,IAAI,CAAC7I,GAAL,KAAaI,OAApB;AACD,KAFM,CAAP;AAGD,GAJD;;AAMAb,EAAAA,KAAK,CAACkI,cAAN,GAAwBqB,OAAD,IAAa;AAClC,WAAOvJ,KAAK,CAACqJ,UAAN,CAAkB5I,GAAD,IAAS;AAC/B,aAAO8I,OAAO,CAAClH,QAAR,CAAiB5B,GAAG,CAACA,GAArB,CAAP;AACD,KAFM,CAAP;AAGD,GAJD;;AAMAT,EAAAA,KAAK,CAACqJ,UAAN,GAAoBG,MAAD,IAAY;AAC7B,WAAO9I,oBAAW2I,UAAX,CAAsBhI,KAAK,CAAC4D,IAA5B,EAAkCuE,MAAlC,CAAP;AACD,GAFD;;AAIAxJ,EAAAA,KAAK,CAACyJ,aAAN,GAAuBxE,IAAD,IAAU;AAC9B,WAAOvE,oBAAW+I,aAAX,CAAyB5J,OAAzB,EAAkCE,IAAlC,EAAwCkF,IAAxC,EAA8CnF,iBAA9C,CAAP;AACD,GAFD;;AAIAE,EAAAA,KAAK,CAAC0J,YAAN,GAAsB7I,OAAD,IAAa;AAAA;;AAChC,UAAM;AAACoE,MAAAA;AAAD,8BAASpF,OAAO,CAACoI,OAAR,CAAgB,CAAhB,CAAT,mEAA+B,EAArC;AAEA,WAAO0B,OAAO,CAAC1E,IAAI,IAAIA,IAAI,CAAC5C,QAAL,CAAcxB,OAAd,CAAT,CAAd;AACD,GAJD;;AAMAb,EAAAA,KAAK,CAAC4J,YAAN,GAAqB,MAAM;AACzB,WAAO,CAAC,GAAGjI,SAAJ,EAAeP,IAAf,EAAqByI,OAArB,GAA+BC,IAA/B,CAAqCC,MAAD,IAAY;AACrD,aAAOA,MAAM,IAAI,CAAC,kBAAD,EAAqB,iBAArB,EAAwC1H,QAAxC,CAAiD0H,MAAM,CAACzH,IAAxD,CAAjB;AACD,KAFM,KAED,IAFN;AAGD,GAJD;;AAMAtC,EAAAA,KAAK,CAACgK,aAAN,GAAsB,MAAM;AAC1B,UAAMC,SAAS,GAAGjK,KAAK,CAAC4J,YAAN,EAAlB;;AAEA,QAAI,CAACK,SAAL,EAAgB;AACd,aAAO,IAAP;AACD;;AAED,UAAMC,cAAc,GAAG,mCAAgBrI,UAAhB,EAA4BoI,SAA5B,EAAuC;AAC5D/H,MAAAA,QAD4D;AAE5DC,MAAAA;AAF4D,KAAvC,CAAvB;;AAKA,QAAI+H,cAAJ,EAAoB;AAClB,YAAMC,KAAK,GAAG,IAAIC,MAAJ,CAAWF,cAAc,CAAC9J,GAAf,CAAmBC,KAAnB,CAAyBC,MAApC,CAAd;AAEA,aAAO,gCAAa4J,cAAb,EAA6BC,KAA7B,CAAP;AACD;;AAED,WAAO,IAAP;AACD,GAnBD;;AAqBAnK,EAAAA,KAAK,CAAC4H,WAAN,GAAqB/G,OAAD,IAAa;AAC/B,UAAMwJ,UAAU,GAAGrK,KAAK,CAACgK,aAAN,EAAnB;AAEA,WAAOL,OAAO,CAACU,UAAD,CAAP,IAAuB3J,oBAAW0G,MAAX,CAAkBiD,UAAlB,EAA8BxJ,OAA9B,CAA9B;AACD,GAJD;;AAMAb,EAAAA,KAAK,CAACsK,mBAAN,GAA4B,CAACzJ,OAAD,EAAU0J,YAAV,EAAwBtD,uBAAuB,GAAG,KAAlD,KAA4D;AACtF,UAAMtB,aAAa,GAAG3F,KAAK,CAACe,mBAAN,CAA0B;AAC9CkG,MAAAA,uBAD8C;AAE9CpG,MAAAA;AAF8C,KAA1B,CAAtB;;AAIA,QAAI,CAAC8E,aAAD,IACFsB,uBAAuB,IAAItB,aAA3B,IAA4C,OAAOA,aAAP,KAAyB,QADvE,EAEE;AACA;AACD;;AACD,UAAM6E,iBAAiB,GAAGC,gBAAEjB,MAAF,CAASnI,KAAK,CAAC4D,IAAf,EAAqB;AAC7CxE,MAAAA,GAAG,EAAEkF;AADwC,KAArB,CAA1B;;AAIA6E,IAAAA,iBAAiB,CAACjG,OAAlB,CAA2BmG,gBAAD,IAAsB;AAC9CH,MAAAA,YAAY,CAACG,gBAAD,EAAmB/E,aAAnB,CAAZ;AACD,KAFD;AAGD,GAjBD;;AAmBA,SAAO3F,KAAP;AACD,CA9fD;;AAggBA,MAAM2K,WAAW,GAAI9K,OAAD,IAAa;AAAA;;AAC/B;AACA,QAAM0B,QAAQ,GAAG;AACf;AACAqJ,IAAAA,aAAa,EAAEjB,OAAO,0BAAC9J,OAAO,CAAC0B,QAAR,CAAiBF,KAAlB,0DAAC,sBAAwBuJ,aAAzB,CAFP;AAGfC,IAAAA,cAAc,EAAElB,OAAO,2BAAC9J,OAAO,CAAC0B,QAAR,CAAiBF,KAAlB,2DAAC,uBAAwBwJ,cAAzB,CAHR;AAIf3I,IAAAA,QAAQ,EAAE4I,MAAM,qDAACjL,OAAO,CAAC0B,QAAR,CAAiBF,KAAlB,2DAAC,uBAAwBa,QAAzB,2EAAqC,CAArC,CAJD;AAKfC,IAAAA,QAAQ,EAAE2I,MAAM,qDAACjL,OAAO,CAAC0B,QAAR,CAAiBF,KAAlB,2DAAC,uBAAwBc,QAAzB,2EAAqC,CAArC,CALD;AAOf;AACArC,IAAAA,iBAAiB,sDAAED,OAAO,CAAC0B,QAAR,CAAiBF,KAAnB,2DAAE,uBAAwBvB,iBAA1B,2EAA+C,EARjD;AAUf;AACAiL,IAAAA,cAAc,uDAAElL,OAAO,CAAC0B,QAAR,CAAiBF,KAAnB,4DAAE,wBAAwB0J,cAA1B,2EAA4C,EAX3C;AAaf;AACAnC,IAAAA,cAAc,wDAAE/I,OAAO,CAAC0B,QAAR,CAAiBF,KAAnB,4DAAE,wBAAwBuH,cAA1B,6EAA4C,EAd3C;AAgBf;AACA7G,IAAAA,oBAAoB,6BAAElC,OAAO,CAAC0B,QAAR,CAAiBF,KAAnB,4DAAE,wBAAwBU,oBAjB/B;AAkBfC,IAAAA,sBAAsB,6BAAEnC,OAAO,CAAC0B,QAAR,CAAiBF,KAAnB,4DAAE,wBAAwBW,sBAlBjC;AAmBfC,IAAAA,2BAA2B,6BAAEpC,OAAO,CAAC0B,QAAR,CAAiBF,KAAnB,4DAAE,wBAAwBY,2BAnBtC;AAqBf;AACAlC,IAAAA,IAAI,wDAAEF,OAAO,CAAC0B,QAAR,CAAiBF,KAAnB,4DAAE,wBAAwBtB,IAA1B,6EACDF,OAAO,CAACmL,UAAR,CAAmB3I,QAAnB,CAA4B,oBAA5B,IAAoD,YAApD,GAAmE;AAvBvD,GAAjB;AAyBA;;AAEA3B,sBAAWuK,eAAX,CAA2B1J,QAAQ,CAACxB,IAApC;;AACA,MAAI;AACFW,wBAAWwK,oBAAX,CAAgC3J,QAAQ,CAACqH,cAAzC;AACD,GAFD,CAEE,OAAOuC,KAAP,EAAc;AACdtL,IAAAA,OAAO,CAACM,MAAR,CAAe;AACbC,MAAAA,GAAG,EAAE;AACHC,QAAAA,KAAK,EAAE;AACLC,UAAAA,MAAM,EAAE,CADH;AAELC,UAAAA,IAAI,EAAE;AAFD;AADJ,OADQ;AAObL,MAAAA,OAAO,EAAEiL,KAAK,CAACjL;AAPF,KAAf;AAUA,WAAO,KAAP;AACD;;AAED,SAAOqB,QAAP;AACD,CA/CD;AAiDA;AACA;AACA;AACA;AACA;AACA;;;;;AACA,MAAM6J,UAAU,GAAG,CAACvL,OAAD,EAAUwL,WAAV,KAA0B;AAC3C,QAAMlL,MAAM,GAAG,CAACD,OAAD,EAAUoL,GAAG,GAAG,IAAhB,EAAsBC,QAAQ,GAAG,IAAjC,EAAuCC,IAAI,GAAG,IAA9C,KAAuD;AACpE,QAAIpL,GAAJ;;AAEA,QAAImL,QAAJ,EAAc;AACZ,UAAI,EAAE,UAAUA,QAAZ,CAAJ,EAA2B;AACzBA,QAAAA,QAAQ,CAAChL,IAAT,GAAgBgL,QAAQ,CAAChI,MAAT,CAAgB,CAAhB,EAAmBmB,MAAnC;AACD;;AAED,YAAM+G,UAAU,GAAGJ,WAAW,CAACjL,GAAZ,CAAgBC,KAAhB,CAAsBE,IAAtB,GAA6BgL,QAAQ,CAAChL,IAAzD;AAEAH,MAAAA,GAAG,GAAG;AACJsD,QAAAA,GAAG,EAAE;AAACnD,UAAAA,IAAI,EAAEkL;AAAP,SADD;AAEJpL,QAAAA,KAAK,EAAE;AAACE,UAAAA,IAAI,EAAEkL;AAAP;AAFH,OAAN;;AAIA,UAAIF,QAAQ,CAACjL,MAAb,EAAqB;AACnB,cAAMoL,SAAS,GAAGL,WAAW,CAACjL,GAAZ,CAAgBC,KAAhB,CAAsBC,MAAtB,GAA+BiL,QAAQ,CAACjL,MAA1D;AAEAF,QAAAA,GAAG,CAACsD,GAAJ,CAAQpD,MAAR,GAAiBoL,SAAjB;AACAtL,QAAAA,GAAG,CAACC,KAAJ,CAAUC,MAAV,GAAmBoL,SAAnB;AACD;AACF;;AAED7L,IAAAA,OAAO,CAACM,MAAR,CAAe;AACbqL,MAAAA,IADa;AAEbF,MAAAA,GAFa;AAGblL,MAAAA,GAHa;AAIbF,MAAAA,OAJa;AAKbkB,MAAAA,IAAI,EAAEiK;AALO,KAAf;AAOD,GA7BD;;AA+BA,SAAOlL,MAAP;AACD,CAjCD;AAmCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAEA,MAAMwL,OAAO,GAAG,CACdC,IADc,EAEdlK,MAFc,EAENL,KAFM,EAGdI,UAHc,EAGF5B,OAHE,EAGOwG,KAHP,EAGc/E,SAHd,EAGyBF,IAHzB,EAG+BG,QAH/B,EAIdM,UAJc,EAIFgK,QAJE,EAIQC,KAJR,EAIetK,YAJf,KAKX;AACH,QAAMrB,MAAM,GAAGiL,UAAU,CAACvL,OAAD,EAAUyB,SAAV,CAAzB;AAEA,QAAMtB,KAAK,GAAGmB,QAAQ,CACpBC,IADoB,EAEpBC,KAFoB,EAGpBC,SAHoB,EAIpBC,QAJoB,EAKpBpB,MALoB,EAMpBN,OANoB,EAOpB2B,YAPoB,EAQpBC,UARoB,EASpBC,MAToB,CAAtB;;AAYA,MACE,CAACD,UAAU,CAACsK,aAAZ,IAA6BxK,QAAQ,CAACsJ,cAAtC,IACA7K,KAAK,CAACoH,MAAN,CAAa,UAAb,CAFF,EAGE;AACA;AACD;;AACD,MACE,CAAC3F,UAAU,CAACuK,YAAZ,IAA4BzK,QAAQ,CAACqJ,aAArC,KACC5K,KAAK,CAACoH,MAAN,CAAa,SAAb,KAA2BqD,gBAAEjB,MAAF,CAASnI,KAAK,CAAC4D,IAAf,EAAqB;AAC/CxE,IAAAA,GAAG,EAAE;AAD0C,GAArB,EAEzB+C,IAFyB,CAEpB,CAAC;AAACM,IAAAA;AAAD,GAAD,KAAmB;AACzB,WAAOA,WAAW,KAAK,SAAvB;AACD,GAJ2B,CAD5B,CADF,EAOE;AACA;AACD;;AAED+H,EAAAA,QAAQ,CAAC;AACPhM,IAAAA,OADO;AAEPH,IAAAA,WAFO;AAGPgC,IAAAA,MAHO;AAIPkK,IAAAA,IAJO;AAKPpK,IAAAA,YALO;AAMPH,IAAAA,KANO;AAOPC,IAAAA,SAPO;AAQPF,IAAAA,IARO;AASPjB,IAAAA,MATO;AAUPoB,IAAAA,QAVO;AAWPM,IAAAA,UAXO;AAYPiK,IAAAA,KAZO;AAaP9L,IAAAA;AAbO,GAAD,CAAR;AAeD,CApDD;;AAsDA,MAAMiM,iBAAiB,GAAG,UAAU5F,KAAV,EAAiB/E,SAAjB,EAA4B;AACpD,QAAM4K,UAAU,GAAG7F,KAAK,CAAC/E,SAAS,CAAClB,GAAV,CAAcC,KAAd,CAAoBE,IAApB,GAA2B,CAA5B,CAAxB;AACA,QAAM4J,KAAK,GAAG+B,UAAU,CAACC,MAAX,CAAkB,CAAlB,EAAqB/B,MAArB,CAA4B9I,SAAS,CAAClB,GAAV,CAAcC,KAAd,CAAoBC,MAAhD,CAAd;AACA,QAAM8L,IAAI,GAAG,gCAAa9K,SAAb,EAAwB6I,KAAxB,CAAb;AAEA,SAAO,CAACA,KAAD,EAAQiC,IAAR,CAAP;AACD,CAND;AAQA;AACA;AACA;AACA;AACA;AACA;AACA;;;AACA,MAAMC,gBAAgB,GAAG,CAACR,QAAD,EAAWpK,UAAX,KAA0B;AACjD,QAAM6K,aAAa,GAAG,EAAtB;AAEA,MAAI/K,QAAJ;;AACA,QAAMgL,YAAY,GAAG,CAAC1M,OAAD,EAAUuB,IAAV,EAAgBoL,UAAhB,EAA4BV,KAA5B,EAAmCW,QAAnC,KAAgD;AACnE,UAAM5K,UAAU,GAAGhC,OAAO,CAACiC,aAAR,EAAnB;AACA,UAAM;AAACuE,MAAAA;AAAD,QAAUxE,UAAhB;AAEA,UAAM7B,KAAK,GAAGJ,aAAa,CAACC,OAAD,EAAU0B,QAAV,CAA3B;AACAiL,IAAAA,UAAU,CAACjI,OAAX,CAAoBjD,SAAD,IAAe;AAChC,UAAI,CAAE,WAAD,CAAcoL,IAAd,CAAmB7K,UAAU,CAAC8K,OAAX,CAAmBrL,SAAnB,CAAnB,CAAL,EAAwD;AACtD;AACD;;AAED,YAAM,CAACI,MAAD,EAASL,KAAT,IAAkB4K,iBAAiB,CACvC5F,KADuC,EAChC/E,SADgC,CAAzC;AAIAqK,MAAAA,OAAO,CACL,IADK,EAELjK,MAFK,EAEGL,KAFH,EAGLI,UAHK,EAGO5B,OAHP,EAGgBwG,KAHhB,EAGuB/E,SAHvB,EAGkCF,IAHlC,EAILG,QAJK,EAIKM,UAJL,EAIiBgK,QAJjB,EAKLC,KALK,EAKE,IALF,CAAP;AAOD,KAhBD;;AAiBA,QAAIW,QAAQ,IAAIhL,UAAU,CAACmL,IAA3B,EAAiC;AAC/BnL,MAAAA,UAAU,CAACmL,IAAX,CAAgB;AACd/M,QAAAA,OADc;AAEdiM,QAAAA,KAFc;AAGd9L,QAAAA;AAHc,OAAhB;AAKD;AACF,GA7BD;;AA+BA,SAAO;AACL6M,IAAAA,MAAM,CAAEhN,OAAF,EAAW;AACf,YAAMgC,UAAU,GAAGhC,OAAO,CAACiC,aAAR,EAAnB;AACAP,MAAAA,QAAQ,GAAGoJ,WAAW,CAAC9K,OAAD,CAAtB;;AACA,UAAI,CAAC0B,QAAL,EAAe;AACb,eAAO,EAAP;AACD;;AAED,YAAMuK,KAAK,GAAG,EAAd;AAEA,aAAO;AACL,yBAAkB1K,IAAlB,EAAwB;AACtB,gBAAM0L,WAAW,GAAG,qCAAkB1L,IAAlB,EAAwBS,UAAxB,CAApB;;AAEA,cAAIT,IAAI,KAAK0L,WAAb,EAA0B;AACxB;AACD;;AAED,gBAAMC,OAAO,GAAG,mCAAgBlL,UAAhB,EAA4BT,IAA5B,EAAkCG,QAAlC,CAAhB;;AACA,cAAI+K,aAAa,CAACjK,QAAd,CAAuB0K,OAAvB,CAAJ,EAAqC;AACnC;AACD;;AACD,cAAI,CAACA,OAAL,EAAc;AACZ,gBAAItL,UAAU,CAACuL,UAAf,EAA2B;AACzBvL,cAAAA,UAAU,CAACuL,UAAX,CAAsB;AACpB5L,gBAAAA,IADoB;AAEpB0K,gBAAAA;AAFoB,eAAtB;AAID;;AAED;AACD;;AAEDQ,UAAAA,aAAa,CAACrI,IAAd,CAAmB8I,OAAnB;AACAR,UAAAA,YAAY,CAAC1M,OAAD,EAAUuB,IAAV,EAAgB,CAAC2L,OAAD,CAAhB,EAA2BjB,KAA3B,CAAZ;AACD,SAzBI;;AA0BL,yBAAkB;AAChB,gBAAMmB,WAAW,GAAGpL,UAAU,CAACqL,cAAX,EAApB;AACA,gBAAMC,cAAc,GAAGF,WAAW,CAACzD,MAAZ,CAAoBpI,IAAD,IAAU;AAClD,mBAAO,CAACkL,aAAa,CAACjK,QAAd,CAAuBjB,IAAvB,CAAR;AACD,WAFsB,CAAvB;AAIAmL,UAAAA,YAAY,CAAC1M,OAAD,EAAU,IAAV,EAAgBsN,cAAhB,EAAgCrB,KAAhC,EAAuC,IAAvC,CAAZ;AACD;;AAjCI,OAAP;AAmCD,KA7CI;;AA8CLhE,IAAAA,IAAI,EAAErG,UAAU,CAACqG;AA9CZ,GAAP;AAgDD,CAnFD;AAqFA;AACA;AACA;AACA;AACA;AACA;AACA;;;AACA,MAAMsF,SAAS,GAAG,CAACvB,QAAD,EAAWpK,UAAX,KAA0B;AAC1C,SAAO;AACLoL,IAAAA,MAAM,CAAEhN,OAAF,EAAW;AACf,YAAMgC,UAAU,GAAGhC,OAAO,CAACiC,aAAR,EAAnB;AACA,YAAMP,QAAQ,GAAGoJ,WAAW,CAAC9K,OAAD,CAA5B;;AACA,UAAI,CAAC0B,QAAL,EAAe;AACb,eAAO,EAAP;AACD;;AAED,aAAO;AACL,yBAAkB;AAChB,gBAAM0L,WAAW,GAAGpL,UAAU,CAACqL,cAAX,EAApB;AACA,gBAAM;AAAC7G,YAAAA;AAAD,cAAUxE,UAAhB;AACA,gBAAM7B,KAAK,GAAGJ,aAAa,CAACC,OAAD,EAAU0B,QAAV,CAA3B;AAEAsK,UAAAA,QAAQ,CAAC;AACPoB,YAAAA,WADO;AAEPpN,YAAAA,OAFO;AAGPwG,YAAAA,KAHO;AAIP+E,YAAAA,UAJO;AAKP7J,YAAAA,QALO;AAMPM,YAAAA,UANO;AAOP7B,YAAAA;AAPO,WAAD,CAAR;AASD;;AAfI,OAAP;AAiBD,KAzBI;;AA0BL8H,IAAAA,IAAI,EAAErG,UAAU,CAACqG;AA1BZ,GAAP;AA4BD,CA7BD;;AAoCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACe,SAASuF,YAAT,CAAuBxB,QAAvB,EAAiCpK,UAAjC,EAA6C;AAAA;;AAC1D,QAAM6L,QAAQ,GAAG7L,UAAH,aAAGA,UAAH,2CAAGA,UAAU,CAAEqG,IAAf,qDAAG,iBAAkBxF,IAAnC;;AACA,MAAI,CAACgL,QAAD,IAAa,CAAC,CAAC,SAAD,EAAY,YAAZ,EAA0B,QAA1B,EAAoCjL,QAApC,CAA6CiL,QAA7C,CAAlB,EAA0E;AACxE,UAAM,IAAIC,SAAJ,CAAc,wFAAd,CAAN;AACD;;AACD,MAAI,OAAO1B,QAAP,KAAoB,UAAxB,EAAoC;AAClC,UAAM,IAAI0B,SAAJ,CAAc,2CAAd,CAAN;AACD;;AAED,MAAI9L,UAAU,CAAC2L,SAAf,EAA0B;AACxB,WAAOA,SAAS,CAACvB,QAAD,EAAWpK,UAAX,CAAhB;AACD;;AAED,MAAIA,UAAU,CAAC4K,gBAAf,EAAiC;AAC/B,WAAOA,gBAAgB,CAACR,QAAD,EAAWpK,UAAX,CAAvB;AACD;;AAED,SAAO;AACL;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACIoL,IAAAA,MAAM,CAAEhN,OAAF,EAAW;AACf,UAAI2N,QAAJ;;AACA,UAAI/L,UAAU,CAACgM,eAAX,IAA8BhM,UAAU,CAACiM,eAA7C,EAA8D;AAAA;;AAC5DF,QAAAA,QAAQ,GAAG9M,oBAAWiN,gBAAX,CAA4B9N,OAA5B,EAAqC4B,UAAU,CAACgM,eAAhD,CAAX;;AACA,yBAAID,QAAJ,sCAAI,UAAUnL,QAAV,CAAmB,KAAnB,CAAJ,EAA+B;AAC7B,iBAAOgK,gBAAgB,CAACR,QAAD,EAAWpK,UAAX,CAAhB,CAAuCoL,MAAvC,CAA8ChN,OAA9C,CAAP;AACD;AACF;;AACD,YAAMgC,UAAU,GAAGhC,OAAO,CAACiC,aAAR,EAAnB;AACA,YAAMP,QAAQ,GAAGoJ,WAAW,CAAC9K,OAAD,CAA5B;;AACA,UAAI,CAAC0B,QAAL,EAAe;AACb,eAAO,EAAP;AACD;;AACD,YAAM;AAAC8E,QAAAA;AAAD,UAAUxE,UAAhB;AAEA,YAAMiK,KAAK,GAAG,EAAd;;AAEA,YAAM8B,UAAU,GAAG,CAAChC,IAAD,EAAO9I,OAAP,EAAgB1B,IAAhB,KAAyB;AAC1C,cAAME,SAAS,GAAG,mCAAgBO,UAAhB,EAA4BT,IAA5B,EAAkCG,QAAlC,CAAlB;;AAEA,YAAI,CAACD,SAAL,EAAgB;AACd;AACD;;AAED,cAAM,CAACI,MAAD,EAASL,KAAT,IAAkB4K,iBAAiB,CACvC5F,KADuC,EAChC/E,SADgC,CAAzC;;AAIA,aACE;AACA;AACA;AACAwB,QAAAA,OAAO,IAAIA,OAAO,CAACzB,KAAD,CAAP,KAAmB,KAJhC,EAKE;AACA;AACD;;AAEDsK,QAAAA,OAAO,CACLC,IADK,EACClK,MADD,EACSL,KADT,EAELI,UAFK,EAEO5B,OAFP,EAEgBwG,KAFhB,EAEuB/E,SAFvB,EAEkCF,IAFlC,EAGLG,QAHK,EAGKM,UAHL,EAGiBgK,QAHjB,EAG2BC,KAH3B,CAAP;AAKD,OAzBD;;AA2BA,UAAI+B,aAAa,GAAG,EAApB;;AAEA,UAAIL,QAAQ,KAAK/L,UAAU,CAACgM,eAAX,IAA8BhM,UAAU,CAACiM,eAA9C,CAAZ,EAA4E;AAC1EG,QAAAA,aAAa,GAAGnN,oBAAWoN,gBAAX,CACdN,QADc,EAEdI,UAFc,EAGd,kCAAerM,QAAf,CAHc,CAAhB;AAKD,OAND,MAMO;AACL,SACE,yBADF,EAEE,qBAFF,EAGE,oBAHF,EAIEgD,OAJF,CAIWwJ,IAAD,IAAU;AAClBF,UAAAA,aAAa,CAACE,IAAD,CAAb,GAAsBH,UAAU,CAACI,IAAX,CAAgB,IAAhB,EAAsB;AAC1CC,YAAAA,QAAQ,EAAEF;AADgC,WAAtB,EAEnB,IAFmB,CAAtB;AAGD,SARD;AASD;;AAED,UAAItM,UAAU,CAACmL,IAAf,EAAqB;AACnBiB,QAAAA,aAAa,CAAC,cAAD,CAAb,GAAgC,MAAM;AACpCpM,UAAAA,UAAU,CAACmL,IAAX,CAAgB;AACd/M,YAAAA,OADc;AAEdiM,YAAAA;AAFc,WAAhB;AAID,SALD;AAMD;;AAED,aAAO+B,aAAP;AACD,KApFI;;AAqFL/F,IAAAA,IAAI,EAAErG,UAAU,CAACqG;AArFZ,GAAP;AAuFD","sourcesContent":["import {\n  getReducedASTNode, getJSDocComment, commentHandler, parseComment,\n} from '@es-joy/jsdoccomment';\nimport {\n  stringify as commentStringify,\n} from 'comment-parser';\nimport {\n  rewireSpecs,\n  seedTokens,\n} from 'comment-parser/lib/util';\nimport _ from 'lodash';\nimport jsdocUtils from './jsdocUtils';\n\n/*\nconst {\n   align as commentAlign,\n  flow: commentFlow,\n  indent: commentIndent,\n} = transforms;\n*/\n\nconst globalState = new Map();\n\nconst getBasicUtils = (context, {tagNamePreference, mode}) => {\n  const utils = {};\n  utils.reportSettings = (message) => {\n    context.report({\n      loc: {\n        start: {\n          column: 1,\n          line: 1,\n        },\n      },\n      message,\n    });\n  };\n\n  utils.parseClosureTemplateTag = (tag) => {\n    return jsdocUtils.parseClosureTemplateTag(tag);\n  };\n\n  utils.pathDoesNotBeginWith = jsdocUtils.pathDoesNotBeginWith;\n\n  utils.getPreferredTagNameObject = ({tagName}) => {\n    const ret = jsdocUtils.getPreferredTagName(context, mode, tagName, tagNamePreference);\n    const isObject = ret && typeof ret === 'object';\n    if (ret === false || isObject && !ret.replacement) {\n      return {\n        blocked: true,\n        tagName,\n      };\n    }\n\n    return ret;\n  };\n\n  return utils;\n};\n\nconst getUtils = (\n  node,\n  jsdoc,\n  jsdocNode,\n  settings,\n  report,\n  context,\n  iteratingAll,\n  ruleConfig,\n  indent,\n) => {\n  const ancestors = context.getAncestors();\n  const sourceCode = context.getSourceCode();\n\n  const utils = getBasicUtils(context, settings);\n\n  const {\n    tagNamePreference,\n    overrideReplacesDocs,\n    implementsReplacesDocs,\n    augmentsExtendsReplacesDocs,\n    maxLines,\n    minLines,\n    mode,\n  } = settings;\n\n  utils.isIteratingFunction = () => {\n    return !iteratingAll || [\n      'MethodDefinition',\n      'ArrowFunctionExpression',\n      'FunctionDeclaration',\n      'FunctionExpression',\n    ].includes(node && node.type);\n  };\n\n  utils.isVirtualFunction = () => {\n    return iteratingAll && utils.hasATag(['callback', 'function', 'func', 'method']);\n  };\n\n  utils.stringify = (tagBlock, specRewire) => {\n    return commentStringify(specRewire ? rewireSpecs(tagBlock) : tagBlock);\n  };\n\n  utils.reportJSDoc = (msg, tag, handler, specRewire) => {\n    report(msg, handler ? (fixer) => {\n      handler();\n      const replacement = utils.stringify(jsdoc, specRewire);\n\n      return fixer.replaceText(jsdocNode, replacement);\n    } : null, tag);\n  };\n\n  utils.getRegexFromString = (str, requiredFlags) => {\n    return jsdocUtils.getRegexFromString(str, requiredFlags);\n  };\n\n  utils.getTagDescription = (tg) => {\n    const descriptions = [];\n    tg.source.some(({\n      tokens: {end, postDelimiter, tag, postTag, name, type, description},\n    }) => {\n      const desc = (\n        tag && postTag ||\n        !tag && !name && !type && postDelimiter || ''\n\n      // Remove space\n      ).slice(1) +\n        (description || '');\n\n      if (end) {\n        if (desc) {\n          descriptions.push(desc);\n        }\n\n        return true;\n      }\n      descriptions.push(desc);\n\n      return false;\n    });\n\n    return descriptions.join('\\n');\n  };\n\n  utils.getDescription = () => {\n    const descriptions = [];\n    let lastDescriptionLine = 0;\n    jsdoc.source.some(({tokens: {description, tag, end}}, idx) => {\n      if (idx && (tag || end)) {\n        lastDescriptionLine = idx - 1;\n\n        return true;\n      }\n      if (idx || description) {\n        descriptions.push(description);\n      }\n\n      return false;\n    });\n\n    return {\n      description: descriptions.join('\\n'),\n      lastDescriptionLine,\n    };\n  };\n\n  utils.changeTag = (tag, ...tokens) => {\n    tag.source.forEach((src, idx) => {\n      src.tokens = {\n        ...src.tokens,\n        ...tokens[idx],\n      };\n    });\n  };\n\n  utils.setTag = (tag, tokens) => {\n    tag.source = [{\n      // Or tag.source[0].number?\n      number: tag.line,\n      tokens: seedTokens({\n        delimiter: '*',\n        postDelimiter: ' ',\n        start: indent + ' ',\n        tag: '@' + tag.tag,\n        ...tokens,\n      }),\n    }];\n  };\n\n  utils.removeTag = (idx) => {\n    return utils.removeTagItem(idx);\n  };\n\n  utils.removeTagItem = (tagIndex, tagSourceOffset = 0) => {\n    const {source: tagSource} = jsdoc.tags[tagIndex];\n    let lastIndex;\n    const firstNumber = jsdoc.source[0].number;\n    tagSource.some(({number}, tagIdx) => {\n      const sourceIndex = jsdoc.source.findIndex(({\n        number: srcNumber, tokens: {end},\n      }) => {\n        return number === srcNumber && !end;\n      });\n      // istanbul ignore else\n      if (sourceIndex > -1) {\n        let spliceCount = 1;\n        tagSource.slice(tagIdx + 1).some(({tokens: {tag, end}}) => {\n          if (!tag && !end) {\n            spliceCount++;\n\n            return false;\n          }\n\n          return true;\n        });\n        jsdoc.source.splice(sourceIndex + tagSourceOffset, spliceCount - tagSourceOffset);\n        tagSource.splice(tagIdx + tagSourceOffset, spliceCount - tagSourceOffset);\n        lastIndex = sourceIndex;\n\n        return true;\n      }\n\n      // istanbul ignore next\n      return false;\n    });\n    jsdoc.source.slice(lastIndex).forEach((src, idx) => {\n      src.number = firstNumber + lastIndex + idx;\n    });\n  };\n\n  utils.addTag = (targetTagName) => {\n    const number = (jsdoc.tags[jsdoc.tags.length - 1]?.source[0]?.number ?? 0) + 1;\n    jsdoc.source.splice(number, 0, {\n      number,\n      source: '',\n      tokens: seedTokens({\n        delimiter: '*',\n        postDelimiter: ' ',\n        start: indent + ' ',\n        tag: `@${targetTagName}`,\n      }),\n    });\n    jsdoc.source.slice(number + 1).forEach((src) => {\n      src.number++;\n    });\n  };\n\n  utils.seedTokens = seedTokens;\n\n  utils.addLine = (sourceIndex, tokens) => {\n    const number = (jsdoc.source[sourceIndex - 1]?.number || 0) + 1;\n    jsdoc.source.splice(sourceIndex, 0, {\n      number,\n      source: '',\n      tokens: seedTokens(tokens),\n    });\n\n    // If necessary, we can rewire the tags (misnamed method)\n    // rewireSource(jsdoc);\n  };\n\n  utils.addLines = (tagIndex, tagSourceOffset, numLines) => {\n    const {source: tagSource} = jsdoc.tags[tagIndex];\n    let lastIndex;\n    const firstNumber = jsdoc.source[0].number;\n    tagSource.some(({number}) => {\n      const makeLine = () => {\n        return {\n          number,\n          source: '',\n          tokens: seedTokens({\n            delimiter: '*',\n            start: indent + ' ',\n          }),\n        };\n      };\n      const makeLines = () => {\n        return Array.from({length: numLines}, makeLine);\n      };\n      const sourceIndex = jsdoc.source.findIndex(({\n        number: srcNumber, tokens: {end},\n      }) => {\n        return number === srcNumber && !end;\n      });\n      // istanbul ignore else\n      if (sourceIndex > -1) {\n        const lines = makeLines();\n        jsdoc.source.splice(sourceIndex + tagSourceOffset, 0, ...lines);\n\n        // tagSource.splice(tagIdx + 1, 0, ...makeLines());\n        lastIndex = sourceIndex;\n\n        return true;\n      }\n\n      // istanbul ignore next\n      return false;\n    });\n    jsdoc.source.slice(lastIndex).forEach((src, idx) => {\n      src.number = firstNumber + lastIndex + idx;\n    });\n  };\n\n  utils.flattenRoots = (params) => {\n    return jsdocUtils.flattenRoots(params);\n  };\n\n  utils.getFunctionParameterNames = (useDefaultObjectProperties) => {\n    return jsdocUtils.getFunctionParameterNames(node, useDefaultObjectProperties);\n  };\n\n  utils.hasParams = () => {\n    return jsdocUtils.hasParams(node);\n  };\n\n  utils.isGenerator = () => {\n    return node && (\n      node.generator ||\n      node.type === 'MethodDefinition' && node.value.generator ||\n      ['ExportNamedDeclaration', 'ExportDefaultDeclaration'].includes(node.type) &&\n        node.declaration.generator\n    );\n  };\n\n  utils.isConstructor = () => {\n    return jsdocUtils.isConstructor(node);\n  };\n\n  utils.getJsdocTagsDeep = (tagName) => {\n    const name = utils.getPreferredTagName({tagName});\n    if (!name) {\n      return false;\n    }\n\n    return jsdocUtils.getJsdocTagsDeep(jsdoc, name);\n  };\n\n  utils.getPreferredTagName = ({tagName, skipReportingBlockedTag = false, allowObjectReturn = false, defaultMessage = `Unexpected tag \\`@${tagName}\\``}) => {\n    const ret = jsdocUtils.getPreferredTagName(context, mode, tagName, tagNamePreference);\n    const isObject = ret && typeof ret === 'object';\n    if (utils.hasTag(tagName) && (ret === false || isObject && !ret.replacement)) {\n      if (skipReportingBlockedTag) {\n        return {\n          blocked: true,\n          tagName,\n        };\n      }\n      const message = isObject && ret.message || defaultMessage;\n      report(message, null, utils.getTags(tagName)[0]);\n\n      return false;\n    }\n\n    return isObject && !allowObjectReturn ? ret.replacement : ret;\n  };\n\n  utils.isValidTag = (name, definedTags) => {\n    return jsdocUtils.isValidTag(context, mode, name, definedTags);\n  };\n\n  utils.hasATag = (names) => {\n    return jsdocUtils.hasATag(jsdoc, names);\n  };\n\n  utils.hasTag = (name) => {\n    return jsdocUtils.hasTag(jsdoc, name);\n  };\n\n  utils.comparePaths = (name) => {\n    return jsdocUtils.comparePaths(name);\n  };\n\n  utils.dropPathSegmentQuotes = (name) => {\n    return jsdocUtils.dropPathSegmentQuotes(name);\n  };\n\n  utils.avoidDocs = () => {\n    if (\n      overrideReplacesDocs !== false &&\n        (utils.hasTag('override') || utils.classHasTag('override')) ||\n      implementsReplacesDocs !== false &&\n        (utils.hasTag('implements') || utils.classHasTag('implements')) ||\n\n      augmentsExtendsReplacesDocs &&\n        (utils.hasATag(['augments', 'extends']) ||\n          utils.classHasTag('augments') ||\n            utils.classHasTag('extends'))) {\n      return true;\n    }\n\n    if (jsdocUtils.exemptSpeciaMethods(\n      jsdoc, node, context, ruleConfig.meta.schema,\n    )) {\n      return true;\n    }\n\n    const exemptedBy = context.options[0]?.exemptedBy ?? [\n      'inheritDoc',\n      ...mode === 'closure' ? [] : ['inheritdoc'],\n    ];\n    if (exemptedBy.length && utils.getPresentTags(exemptedBy).length) {\n      return true;\n    }\n\n    return false;\n  };\n\n  [\n    'tagMightHaveNamePosition',\n    'tagMightHaveTypePosition',\n  ].forEach((method) => {\n    utils[method] = (tagName, otherModeMaps) => {\n      const result = jsdocUtils[method](tagName);\n      if (result) {\n        return true;\n      }\n\n      if (!otherModeMaps) {\n        return false;\n      }\n\n      const otherResult = otherModeMaps.some((otherModeMap) => {\n        return jsdocUtils[method](tagName, otherModeMap);\n      });\n\n      return otherResult ? {otherMode: true} : false;\n    };\n  });\n\n  [\n    'tagMustHaveNamePosition',\n    'tagMustHaveTypePosition',\n    'tagMissingRequiredTypeOrNamepath',\n  ].forEach((method) => {\n    utils[method] = (tagName, otherModeMaps) => {\n      const result = jsdocUtils[method](tagName);\n      if (!result) {\n        return false;\n      }\n\n      // if (!otherModeMaps) { return true; }\n\n      const otherResult = otherModeMaps.every((otherModeMap) => {\n        return jsdocUtils[method](tagName, otherModeMap);\n      });\n\n      return otherResult ? true : {otherMode: false};\n    };\n  });\n\n  [\n    'isNamepathDefiningTag',\n    'tagMightHaveNamepath',\n  ].forEach((method) => {\n    utils[method] = (tagName) => {\n      return jsdocUtils[method](tagName);\n    };\n  });\n\n  utils.getTagStructureForMode = (mde) => {\n    return jsdocUtils.getTagStructureForMode(mde, settings.structuredTags);\n  };\n\n  utils.hasDefinedTypeTag = (tag) => {\n    return jsdocUtils.hasDefinedTypeTag(tag);\n  };\n\n  utils.hasValueOrExecutorHasNonEmptyResolveValue = (anyPromiseAsReturn) => {\n    return jsdocUtils.hasValueOrExecutorHasNonEmptyResolveValue(node, anyPromiseAsReturn);\n  };\n\n  utils.hasYieldValue = () => {\n    if (['ExportNamedDeclaration', 'ExportDefaultDeclaration'].includes(node.type)) {\n      return jsdocUtils.hasYieldValue(node.declaration);\n    }\n\n    return jsdocUtils.hasYieldValue(node);\n  };\n\n  utils.hasYieldReturnValue = () => {\n    return jsdocUtils.hasYieldValue(node, true);\n  };\n\n  utils.hasThrowValue = () => {\n    return jsdocUtils.hasThrowValue(node);\n  };\n\n  utils.isAsync = () => {\n    return node.async;\n  };\n\n  utils.getTags = (tagName) => {\n    return utils.filterTags((item) => {\n      return item.tag === tagName;\n    });\n  };\n\n  utils.getPresentTags = (tagList) => {\n    return utils.filterTags((tag) => {\n      return tagList.includes(tag.tag);\n    });\n  };\n\n  utils.filterTags = (filter) => {\n    return jsdocUtils.filterTags(jsdoc.tags, filter);\n  };\n\n  utils.getTagsByType = (tags) => {\n    return jsdocUtils.getTagsByType(context, mode, tags, tagNamePreference);\n  };\n\n  utils.hasOptionTag = (tagName) => {\n    const {tags} = context.options[0] ?? {};\n\n    return Boolean(tags && tags.includes(tagName));\n  };\n\n  utils.getClassNode = () => {\n    return [...ancestors, node].reverse().find((parent) => {\n      return parent && ['ClassDeclaration', 'ClassExpression'].includes(parent.type);\n    }) || null;\n  };\n\n  utils.getClassJsdoc = () => {\n    const classNode = utils.getClassNode();\n\n    if (!classNode) {\n      return null;\n    }\n\n    const classJsdocNode = getJSDocComment(sourceCode, classNode, {\n      maxLines,\n      minLines,\n    });\n\n    if (classJsdocNode) {\n      const indnt = ' '.repeat(classJsdocNode.loc.start.column);\n\n      return parseComment(classJsdocNode, indnt);\n    }\n\n    return null;\n  };\n\n  utils.classHasTag = (tagName) => {\n    const classJsdoc = utils.getClassJsdoc();\n\n    return Boolean(classJsdoc) && jsdocUtils.hasTag(classJsdoc, tagName);\n  };\n\n  utils.forEachPreferredTag = (tagName, arrayHandler, skipReportingBlockedTag = false) => {\n    const targetTagName = utils.getPreferredTagName({\n      skipReportingBlockedTag,\n      tagName,\n    });\n    if (!targetTagName ||\n      skipReportingBlockedTag && targetTagName && typeof targetTagName === 'object'\n    ) {\n      return;\n    }\n    const matchingJsdocTags = _.filter(jsdoc.tags, {\n      tag: targetTagName,\n    });\n\n    matchingJsdocTags.forEach((matchingJsdocTag) => {\n      arrayHandler(matchingJsdocTag, targetTagName);\n    });\n  };\n\n  return utils;\n};\n\nconst getSettings = (context) => {\n  /* eslint-disable sort-keys-fix/sort-keys-fix */\n  const settings = {\n    // All rules\n    ignorePrivate: Boolean(context.settings.jsdoc?.ignorePrivate),\n    ignoreInternal: Boolean(context.settings.jsdoc?.ignoreInternal),\n    maxLines: Number(context.settings.jsdoc?.maxLines ?? 1),\n    minLines: Number(context.settings.jsdoc?.minLines ?? 0),\n\n    // `check-tag-names` and many returns/param rules\n    tagNamePreference: context.settings.jsdoc?.tagNamePreference ?? {},\n\n    // `check-types` and `no-undefined-types`\n    preferredTypes: context.settings.jsdoc?.preferredTypes ?? {},\n\n    // `check-types`, `no-undefined-types`, `valid-types`\n    structuredTags: context.settings.jsdoc?.structuredTags ?? {},\n\n    // `require-param`, `require-description`, `require-example`, `require-returns`\n    overrideReplacesDocs: context.settings.jsdoc?.overrideReplacesDocs,\n    implementsReplacesDocs: context.settings.jsdoc?.implementsReplacesDocs,\n    augmentsExtendsReplacesDocs: context.settings.jsdoc?.augmentsExtendsReplacesDocs,\n\n    // Many rules, e.g., `check-tag-names`\n    mode: context.settings.jsdoc?.mode ??\n      (context.parserPath.includes('@typescript-eslint') ? 'typescript' : 'jsdoc'),\n  };\n  /* eslint-enable sort-keys-fix/sort-keys-fix */\n\n  jsdocUtils.setTagStructure(settings.mode);\n  try {\n    jsdocUtils.overrideTagStructure(settings.structuredTags);\n  } catch (error) {\n    context.report({\n      loc: {\n        start: {\n          column: 1,\n          line: 1,\n        },\n      },\n      message: error.message,\n    });\n\n    return false;\n  }\n\n  return settings;\n};\n\n/**\n * Create the report function\n *\n * @param {object} context\n * @param {object} commentNode\n */\nconst makeReport = (context, commentNode) => {\n  const report = (message, fix = null, jsdocLoc = null, data = null) => {\n    let loc;\n\n    if (jsdocLoc) {\n      if (!('line' in jsdocLoc)) {\n        jsdocLoc.line = jsdocLoc.source[0].number;\n      }\n\n      const lineNumber = commentNode.loc.start.line + jsdocLoc.line;\n\n      loc = {\n        end: {line: lineNumber},\n        start: {line: lineNumber},\n      };\n      if (jsdocLoc.column) {\n        const colNumber = commentNode.loc.start.column + jsdocLoc.column;\n\n        loc.end.column = colNumber;\n        loc.start.column = colNumber;\n      }\n    }\n\n    context.report({\n      data,\n      fix,\n      loc,\n      message,\n      node: commentNode,\n    });\n  };\n\n  return report;\n};\n\n/**\n * @typedef {ReturnType<typeof getUtils>} Utils\n * @typedef {ReturnType<typeof getSettings>} Settings\n * @typedef {(\n *   arg: {\n *     context: object,\n *     sourceCode: object,\n *     indent: string,\n *     jsdoc: object,\n *     jsdocNode: object,\n *     node: object | null,\n *     report: ReturnType<typeof makeReport>,\n *     settings: Settings,\n *     utils: Utils,\n *   }\n * ) => any } JsdocVisitor\n */\n\nconst iterate = (\n  info,\n  indent, jsdoc,\n  ruleConfig, context, lines, jsdocNode, node, settings,\n  sourceCode, iterator, state, iteratingAll,\n) => {\n  const report = makeReport(context, jsdocNode);\n\n  const utils = getUtils(\n    node,\n    jsdoc,\n    jsdocNode,\n    settings,\n    report,\n    context,\n    iteratingAll,\n    ruleConfig,\n    indent,\n  );\n\n  if (\n    !ruleConfig.checkInternal && settings.ignoreInternal &&\n    utils.hasTag('internal')\n  ) {\n    return;\n  }\n  if (\n    !ruleConfig.checkPrivate && settings.ignorePrivate &&\n    (utils.hasTag('private') || _.filter(jsdoc.tags, {\n      tag: 'access',\n    }).some(({description}) => {\n      return description === 'private';\n    }))\n  ) {\n    return;\n  }\n\n  iterator({\n    context,\n    globalState,\n    indent,\n    info,\n    iteratingAll,\n    jsdoc,\n    jsdocNode,\n    node,\n    report,\n    settings,\n    sourceCode,\n    state,\n    utils,\n  });\n};\n\nconst getIndentAndJSDoc = function (lines, jsdocNode) {\n  const sourceLine = lines[jsdocNode.loc.start.line - 1];\n  const indnt = sourceLine.charAt(0).repeat(jsdocNode.loc.start.column);\n  const jsdc = parseComment(jsdocNode, indnt);\n\n  return [indnt, jsdc];\n};\n\n/**\n * Create an eslint rule that iterates over all JSDocs, regardless of whether\n * they are attached to a function-like node.\n *\n * @param {JsdocVisitor} iterator\n * @param {{meta: any}} ruleConfig\n */\nconst iterateAllJsdocs = (iterator, ruleConfig) => {\n  const trackedJsdocs = [];\n\n  let settings;\n  const callIterator = (context, node, jsdocNodes, state, lastCall) => {\n    const sourceCode = context.getSourceCode();\n    const {lines} = sourceCode;\n\n    const utils = getBasicUtils(context, settings);\n    jsdocNodes.forEach((jsdocNode) => {\n      if (!(/^\\/\\*\\*\\s/).test(sourceCode.getText(jsdocNode))) {\n        return;\n      }\n\n      const [indent, jsdoc] = getIndentAndJSDoc(\n        lines, jsdocNode,\n      );\n\n      iterate(\n        null,\n        indent, jsdoc,\n        ruleConfig, context, lines, jsdocNode, node,\n        settings, sourceCode, iterator,\n        state, true,\n      );\n    });\n    if (lastCall && ruleConfig.exit) {\n      ruleConfig.exit({\n        context,\n        state,\n        utils,\n      });\n    }\n  };\n\n  return {\n    create (context) {\n      const sourceCode = context.getSourceCode();\n      settings = getSettings(context);\n      if (!settings) {\n        return {};\n      }\n\n      const state = {};\n\n      return {\n        '*:not(Program)' (node) {\n          const reducedNode = getReducedASTNode(node, sourceCode);\n\n          if (node !== reducedNode) {\n            return;\n          }\n\n          const comment = getJSDocComment(sourceCode, node, settings);\n          if (trackedJsdocs.includes(comment)) {\n            return;\n          }\n          if (!comment) {\n            if (ruleConfig.nonComment) {\n              ruleConfig.nonComment({\n                node,\n                state,\n              });\n            }\n\n            return;\n          }\n\n          trackedJsdocs.push(comment);\n          callIterator(context, node, [comment], state);\n        },\n        'Program:exit' () {\n          const allComments = sourceCode.getAllComments();\n          const untrackedJSdoc = allComments.filter((node) => {\n            return !trackedJsdocs.includes(node);\n          });\n\n          callIterator(context, null, untrackedJSdoc, state, true);\n        },\n      };\n    },\n    meta: ruleConfig.meta,\n  };\n};\n\n/**\n * Create an eslint rule that iterates over all JSDocs, regardless of whether\n * they are attached to a function-like node.\n *\n * @param {JsdocVisitor} iterator\n * @param {{meta: any}} ruleConfig\n */\nconst checkFile = (iterator, ruleConfig) => {\n  return {\n    create (context) {\n      const sourceCode = context.getSourceCode();\n      const settings = getSettings(context);\n      if (!settings) {\n        return {};\n      }\n\n      return {\n        'Program:exit' () {\n          const allComments = sourceCode.getAllComments();\n          const {lines} = sourceCode;\n          const utils = getBasicUtils(context, settings);\n\n          iterator({\n            allComments,\n            context,\n            lines,\n            makeReport,\n            settings,\n            sourceCode,\n            utils,\n          });\n        },\n      };\n    },\n    meta: ruleConfig.meta,\n  };\n};\n\nexport {\n  getSettings,\n  parseComment,\n};\n\n/**\n * @param {JsdocVisitor} iterator\n * @param {{\n *   meta: any,\n *   contextDefaults?: true | string[],\n *   contextSelected?: true,\n *   iterateAllJsdocs?: true,\n * }} ruleConfig\n */\nexport default function iterateJsdoc (iterator, ruleConfig) {\n  const metaType = ruleConfig?.meta?.type;\n  if (!metaType || !['problem', 'suggestion', 'layout'].includes(metaType)) {\n    throw new TypeError('Rule must include `meta.type` option (with value \"problem\", \"suggestion\", or \"layout\")');\n  }\n  if (typeof iterator !== 'function') {\n    throw new TypeError('The iterator argument must be a function.');\n  }\n\n  if (ruleConfig.checkFile) {\n    return checkFile(iterator, ruleConfig);\n  }\n\n  if (ruleConfig.iterateAllJsdocs) {\n    return iterateAllJsdocs(iterator, ruleConfig);\n  }\n\n  return {\n    /**\n     * The entrypoint for the JSDoc rule.\n     *\n     * @param {*} context\n     *   a reference to the context which hold all important information\n     *   like settings and the sourcecode to check.\n     * @returns {object}\n     *   a list with parser callback function.\n     */\n    create (context) {\n      let contexts;\n      if (ruleConfig.contextDefaults || ruleConfig.contextSelected) {\n        contexts = jsdocUtils.enforcedContexts(context, ruleConfig.contextDefaults);\n        if (contexts?.includes('any')) {\n          return iterateAllJsdocs(iterator, ruleConfig).create(context);\n        }\n      }\n      const sourceCode = context.getSourceCode();\n      const settings = getSettings(context);\n      if (!settings) {\n        return {};\n      }\n      const {lines} = sourceCode;\n\n      const state = {};\n\n      const checkJsdoc = (info, handler, node) => {\n        const jsdocNode = getJSDocComment(sourceCode, node, settings);\n\n        if (!jsdocNode) {\n          return;\n        }\n\n        const [indent, jsdoc] = getIndentAndJSDoc(\n          lines, jsdocNode,\n        );\n\n        if (\n          // Note, `handler` should already be bound in its first argument\n          //  with these only to be called after the value of\n          //  `comment`\n          handler && handler(jsdoc) === false\n        ) {\n          return;\n        }\n\n        iterate(\n          info, indent, jsdoc,\n          ruleConfig, context, lines, jsdocNode, node,\n          settings, sourceCode, iterator, state,\n        );\n      };\n\n      let contextObject = {};\n\n      if (contexts && (ruleConfig.contextDefaults || ruleConfig.contextSelected)) {\n        contextObject = jsdocUtils.getContextObject(\n          contexts,\n          checkJsdoc,\n          commentHandler(settings),\n        );\n      } else {\n        [\n          'ArrowFunctionExpression',\n          'FunctionDeclaration',\n          'FunctionExpression',\n        ].forEach((prop) => {\n          contextObject[prop] = checkJsdoc.bind(null, {\n            selector: prop,\n          }, null);\n        });\n      }\n\n      if (ruleConfig.exit) {\n        contextObject['Program:exit'] = () => {\n          ruleConfig.exit({\n            context,\n            state,\n          });\n        };\n      }\n\n      return contextObject;\n    },\n    meta: ruleConfig.meta,\n  };\n}\n"],"file":"iterateJsdoc.js"}