(function() {
  var JsonFormatter, _, errorMessages;

  _ = require('lodash');

  errorMessages = require('./error_messages');

  JsonFormatter = (function() {
    function JsonFormatter(arg) {
      this.stream = arg.stream;
    }

    JsonFormatter.prototype.print = function(arg) {
      var data, fixes, ref, results;
      fixes = (ref = arg.fixes) != null ? ref : {}, results = arg.results;
      data = _.mapValues(results, function(modules, type) {
        return _.map(modules, function(module) {
          var error, fixed;
          fixed = _.includes(fixes[type], module.name);
          error = errorMessages[module.error];
          return _.assign({}, module, {
            error: error,
            fixed: fixed
          });
        });
      });
      return this.stream.write(JSON.stringify(data, null, 2), 'utf8');
    };

    return JsonFormatter;

  })();

  module.exports = JsonFormatter;

}).call(this);
